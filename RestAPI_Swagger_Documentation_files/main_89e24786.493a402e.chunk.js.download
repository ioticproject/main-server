(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"+f1A":function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return i});var a=n("QtlZ"),r=n("NFvl"),c=function getSession(){if(!a.a||!a.a.getState)return{};var e=a.a.getState().session;return void 0===e?{}:e},i=function getVisitorTimezone(e){return Object(r.a)(["session","context","timezone"],e)}},"+oIK":function(e,t,n){"use strict";n.d(t,"a",function(){return E}),n.d(t,"b",function(){return m});var a=n("nfbA"),r=n("LeJ0"),c=n("QtlZ"),i=n("SFoa"),o=n("PCkZ"),u=n("LVcX"),s=n("aO/P"),l=n("LeE/"),d=n("hm8b"),f=n("i9gz"),p=n("MFhO"),b=n("PjZB"),v=n("0lfv"),O={widgetVersion:2,widgetRelease:"LOCAL"!==r.a.ENV?"___RELEASE_ID":"local"},g=function resolveAutoAssigneeId(){var e=c.a.getState(),t=e.session.assignedAgentId,n=Object(u.a)({},["embed","configuration"],e).autoAssigneeId,a=Object(u.a)(null,["campaigns","activeCampaign"],e),r=Object(u.a)(!1,["attributes","automaticSender"],a);return n||(t||(r?Object(u.a)(void 0,["attributes","senderId"],a):void 0))},h=function hydrateContextAttributesForMessage(){var e;return Object(a.a)(Object(a.a)(Object(a.a)({locale:Object(i.e)()},function attachRoutingRulesForMessage(){var e={},t=c.a.getState().conversations,n=void 0===t?{}:t,a=Object(u.a)([],["matchedRoutingRules"],n),r=a.map(function(e){return e.id}),i=a.length?Object(s.a)(Object(l.a)(function(e){return e.priority}),a[0],a):null;return i&&i.id&&(e.targetingRuleId=i.id),r&&r.length&&(e.targetingRuleIds=r),e}()),function attachCampaignAttributesForMessage(){var e={},t=c.a.getState().campaigns,n=void 0===t?{}:t,a=n.activeCampaign,r=void 0===a?{}:a,i=n.campaignEvalId;return r.id&&(e.campaignId=r.id,e.relatedCampaignId=r.id,e.isExpandable=!0),i&&(e.targetingEvalUUID=i),e}()),{},{integrations:Object(o.b)(),sentOfflineHours:null===(e=c.a.getState().view)||void 0===e?void 0:e.matchedHours})},E=function createMessage(e){var t=e.message,n=void 0===t?"":t,r=e.activeConversation,i=e.attributes,o=void 0===i?{}:i,s=e.isMetaMessage,l=void 0!==s&&s,E=e.authorId,m=e.status,j=e.attachments,y=void 0===j?[]:j,T=e.preMessages,C=void 0===T?[]:T,I=e.inboxId,x=e.type,S=void 0===x?b.e.CHAT:x,A=e.contentType,k=void 0===A?b.c.CHAT:A,w=e.isEndUserMessage,R=void 0===w||w,M=c.a.getState(),N=Object(u.a)({context:{}},["session"],M),D=Object(u.a)(b.b.LEAD,["session","endUser","type"],M),L=Object(u.a)(null,["campaigns","activeCampaign"],M),H=Object(u.a)({},["embed","configuration"],M).profileMode,V=void 0!==H&&H,U=_(I),P=Object(d.a)(C)||Object(f.a)(C)?function _applyPremessagesForMessage(e,t){var n=Object(u.a)({},["embed","configuration"],c.a.getState()),a=n.profileMode,r=void 0!==a&&a,i=n.team,o=n.theme,s=void 0===o?{}:o,l=g(),d=Object(u.a)(null,["attributes","campaignDisplayType"],t)===p.a.WELCOME_MESSAGE,f=Object(u.a)("",["attributes","message"],t),b=Object(u.a)(null,["attributes","senderId"],t),v=[];if(e)return v;if(r&&l&&v.push({body:s.welcomeMessage,sender:i.find(function(e){return e.id===l})}),d){var O=l||b;v.push({body:f,sender:i.find(function(e){return e.id===O})})}return v}(r,L):C,F=h(),G=R?Object(v.u)():void 0;return{attachments:y,conversationId:r,body:n,type:S,status:m,contentType:k,authorId:E,authorType:D,inboxId:U,attributes:Object(a.a)(Object(a.a)(Object(a.a)({},o),{},{widgetGuid:G,isMetaMessage:l,generatedAt:Date.now().valueOf(),autoAssigneeId:g(),profileMode:V,preMessages:P,isFirstMessage:!r},O),F),context:{userAgent:N.context.userAgent,timezone:N.context.timezone,locale:N.context.locale,page:N.context.page}}},m=function createPreMessagesForCampaign(e){var t=e.body,n=e.attributes,a=(n=void 0===n?{}:n).title,r=void 0===a?null:a,c=n.senderId,i=void 0===c?null:c,o=n.noSenderId,u=void 0!==o&&o,s=n.automaticSender,l=void 0!==s&&s,d=n.campaignDisplayType,f=(void 0===d?null:d)===p.a.WELCOME_MESSAGE,b=j(i,u,l),O=[];return r&&!f&&O.push({id:Object(v.u)(),body:r,sender:b}),t&&O.push({id:Object(v.u)(),body:t,sender:b}),O},j=function getSender(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t)return null;var a=Object(u.a)({},["embed","configuration"],c.a.getState()),r=a.autoAssigneeId,i=a.team,o=c.a.getState().session.assignedAgentId,s=r||o;return n&&s?i.find(function(e){return e.id===s}):i.find(function(t){return t.id===e})},_=function resolveInboxIdForMessage(e){var t=c.a.getState(),n=Object(u.a)({},["embed","configuration"],t).inboxId;if(!Object(d.a)(e))return e;var a=Object(u.a)(null,["conversations","activeConversation"],t),r=Object(u.a)(null,["conversations","conversations",a,"conversation"],t);if(!Object(d.a)(r))return r.inboxId;var i=Object(u.a)(null,["campaigns","activeCampaign","inboxId"],t);return Object(d.a)(i)?n:i}},"1tbh":function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n("mssF"),r=n("0lfv"),c=function sendMessageRoundTripMetric(e){var t=e.message,n=e.timedOut,c=void 0!==n&&n,i=t.attributes,o=void 0===i?{}:i;if(o.generatedAt){var u={isTimeout:c,isFirstMessage:o.isFirstMessage,widgetGuid:o.widgetGuid,messageId:t.id,conversationId:t.conversationId},s=Date.now()-o.generatedAt,l=o.isFirstMessage?"conversationRoundTripTime":"messageRoundTripTime";c?Object(r.v)(["Round-trip timed out for message ".concat(t.id)]):Object(r.n)({data:["Round-trip time for message ".concat(t.id," completed in ").concat(s)]});try{Object(a.e)({name:l,value:s,context:u})}catch(d){Object(r.f)(d)}}}},"2XY6":function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return c});var a=n("i9gz"),r=function shouldWidgetIconDisplay(e){var t,n,r=e.view,c=void 0===r?{}:r,i=e.conversations,o=void 0===i?{}:i,u=e.embed,s=void 0===u?{}:u,l=e.campaigns,d=void 0===l?{}:l,f=c.matchedTargeting,p=o.hasForcedConversation,b=!!(null===d||void 0===d?void 0:null===(t=d.activeCampaign)||void 0===t?void 0:t.id),v=!Object(a.a)(o.conversations);return!(!(null===s||void 0===s?void 0:null===(n=s.configuration)||void 0===n?void 0:n.gates.show_chat_existing_conversations)||!v)||(f||p||b)},c=function isChatOpen(e){var t=e.view;return(void 0===t?{}:t).chatOpen}},BAMi:function(e,t,n){"use strict";var a=n("s8DI"),r=n("WwEg"),c=n("nfbA"),i=n("mj2O"),o=n.n(i),u=n("7SM1"),s=n("QtlZ"),l=n("K0Zh"),d=n("Maj3"),f=n("gG69"),p=n("0lfv"),b=n("7oto"),v=n("OA1u"),O=n("LVcX"),g=n("Jstd"),h=n("4Zd6"),E=n("EQxi"),m=function transformNumericConditionValues(e){return"string"===typeof e?Object(p.t)(e):"object"===typeof e&&e.min&&e.max?{min:Object(p.t)(e.min),max:Object(p.t)(e.max)}:e},j=function getSecondsOnPage(e){var t=Object(O.a)(0,["_window","drift_page_view_started"])(e);return Math.floor((new Date).getTime()/1e3)-t},_=function isAnyOf(e,t){return Object(g.a)(function(e){return t===e})(e)},y=function notIsAnyOf(e,t){return!_(e,t)},T=function is(e,t){return e===t},C=function notIs(e,t){return e!==t},I=function lessThan(e,t){return t<e},x=function greaterThan(e,t){return t>e},S=function isBetween(e,t){return!!e.min&&!!e.max&&t>=e.min&&t<=e.max},A=function includesAnyOf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object(g.a)(function(e){return-1!==t.indexOf(e)})(e)},k=function notIncludesAnyOf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object(h.a)(function(e){return-1===t.indexOf(e)})(e)},w={device:{async:!1,selector:function selector(e){return function resolveDeviceType(e){var t=e.toLowerCase();return t.match(/(mobi|phone|ipod|blackberry|docomo|iphone|android)/i)?"mobile":t.match(/(ipad|kindle)/i)?"tablet":"desktop"}(Object(O.a)("",["_window","userAgent"])(e))},operands:{isAnyOf:_,notIsAnyOf:y}},siteVisits:{async:!1,selector:function selector(e){return Object(O.a)(0,["visitInformation","total"])(e)},transformValueFn:function transformValueFn(e){return m(e)},operands:{is:T,notIs:C,lessThan:I,greaterThan:x,isBetween:S}},daysSinceLastVisit:{async:!1,selector:function selector(e){return Object(O.a)(0,["visitInformation","daysSinceLastVisit"])(e)},transformValueFn:function transformValueFn(e){return m(e)},operands:{is:T,notIs:C,lessThan:I,greaterThan:x,isBetween:S}},referrer:{async:!1,transformValueFn:function transformValueFn(e){return e.map(function(e){return Object(E.c)(e)})},selector:function selector(e){return Object(E.c)(Object(O.a)("",["referrer"])(e))},operands:{is:T,notIs:C,isAnyOf:_,notIsAnyOf:y,includesAnyOf:A,notIncludesAnyOf:k}},cookie:{async:!1,selector:function selector(e){return Object.entries(Object(O.a)({},["cookies"])(e)).map(function(e){return e.join("=")})},operands:{is:A,notIs:k,isAnyOf:A,notIsAnyOf:k,includesAnyOf:A,notIncludesAnyOf:k}},scrollPct:{async:!0,eventType:"scroll",transformValueFn:function transformValueFn(e){return m(e)},selector:function selector(e){var t=Object(O.a)(0,["_window","scrollY"])(e);return(Object(O.a)(0,["_window","innerHeight"])(e)+t)/Object(O.a)(0,["scrollableHeight"])(e)*100},operands:{lessThan:I,greaterThan:x,isBetween:S}},secondsOnPage:{async:!0,timer:!0,eventType:"timer",selector:function selector(e){return j(e)},transformValueFn:function transformValueFn(e){return m(e)},operands:{lessThan:I,greaterThan:x,isBetween:S}},secondsOnSite:{async:!0,timer:!0,eventType:"timer",transformValueFn:function transformValueFn(e){return m(e)},selector:function selector(e){var t=Object(O.a)(0,["_window","drift_session_started"])(e);return Math.floor((new Date).getTime()/1e3)-t},operands:{lessThan:I,greaterThan:x,isBetween:S}},exitIntent:{async:!0,eventType:"mouseleave",eventProperties:["clientY"],selector:function selector(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(O.a)(!1,["hasExitIntent"])(e))return!0;var t=Object(O.a)(0,["_window","innerHeight"])(e),n=Object(O.a)(t,["eventContext","clientY"])(e),a=j(e);return n/t<.5&&a>5},operands:{is:T,notIs:C}},autoAssigneeId:{async:!1,selector:function selector(e){return Object(O.a)("",["embed","configuration","autoAssigneeId"])(e)},operands:{is:T,notIs:C,isAnyOf:_,notIsAnyOf:y}},inboxId:{async:!1,selector:function selector(e){return Object(O.a)("",["embed","configuration","inboxId"])(e)},operands:{isAnyOf:_,notIsAnyOf:y}}},R=function isUnsupportedCondition(e){return!w[e.field]},M=function(){var e=Object(u.a)(o.a.mark(function _callee(e,t){var n,a,r,c,i,u;return o.a.wrap(function _callee$(o){for(;;)switch(o.prev=o.next){case 0:if(!R(e)){o.next=2;break}return o.abrupt("return",Promise.resolve({conditionEvaluation:!0,conditionEvalDetail:{evaluatedCondition:e,matched:!0,status:"EVALUATED"}}));case 2:return n=w[e.field],a=n.operands[e.operator],r=n.transformValueFn?n.transformValueFn(e.value):e.value,o.next=7,n.selector(t,e);case 7:return c=o.sent,i=a(r,c),u={evaluatedCondition:e,matched:i,actualValue:c,status:n.async?i?"EVALUATED":"PENDING":"EVALUATED"},o.abrupt("return",Promise.resolve({conditionEvaluation:i,conditionEvalDetail:u}));case 11:case"end":return o.stop()}},_callee)}));return function evaluateSingleCondition(t,n){return e.apply(this,arguments)}}(),N=function conditionEvaluator(e){return function(t){return M(e,t)}},D=function(){var e=Object(u.a)(o.a.mark(function _callee3(e){var t,n,a,r,c,i,s,l,d,f,p,b,v,O,g;return o.a.wrap(function _callee3$(h){for(;;)switch(h.prev=h.next){case 0:t=e.context,n=e.conditions,a=!1,r=[],c=[],i=function(){var e=Object(u.a)(o.a.mark(function _callee2(e){var n,a,c,i,u,s,l,d,f,p,b,v,O,g,h,E,m;return o.a.wrap(function _callee2$(j){for(;;)switch(j.prev=j.next){case 0:n=!0,a=[],j.t0=o.a.keys(e);case 3:if((j.t1=j.t0()).done){j.next=23;break}return c=j.t1.value,i=e[c],j.next=8,M(i,t);case 8:if(u=j.sent,s=u.conditionEvalDetail,l=u.conditionEvaluation,a.push(s),l||R(s.evaluatedCondition)){j.next=21;break}if(d=w[i.field],f=d.async,p=void 0!==f&&f,b=d.eventType,v=void 0===b?null:b,O=d.timer,g=void 0!==O&&O,h=d.selector,E=d.eventProperties,m=void 0===E?[]:E,n=!1,!p){j.next=19;break}r.push({conditionDefinition:i,selector:h,eventType:v,timer:g,eventProperties:m,type:i.field,evaluator:N(i)}),j.next=21;break;case 19:return r=[],j.abrupt("break",23);case 21:j.next=3;break;case 23:return j.abrupt("return",Promise.resolve({fullGroupMatch:n,groupEval:{targetingConditions:a,status:r.length?"PENDING":"EVALUATED"}}));case 24:case"end":return j.stop()}},_callee2)}));return function evaluateConditions(t){return e.apply(this,arguments)}}(),s=!0,l=!1,d=void 0,h.prev=8,f=n[Symbol.iterator]();case 10:if(s=(p=f.next()).done){h.next=25;break}return b=p.value,h.next=14,i(b);case 14:if(v=h.sent,O=v.fullGroupMatch,g=v.groupEval,c.push(g),!O){h.next=22;break}return a=!0,r=[],h.abrupt("break",25);case 22:s=!0,h.next=10;break;case 25:h.next=31;break;case 27:h.prev=27,h.t0=h.catch(8),l=!0,d=h.t0;case 31:h.prev=31,h.prev=32,s||null==f.return||f.return();case 34:if(h.prev=34,!l){h.next=37;break}throw d;case 37:return h.finish(34);case 38:return h.finish(31);case 39:return h.abrupt("return",Promise.resolve({matched:a,asyncConditionListeners:r,evalLog:c}));case 40:case"end":return h.stop()}},_callee3,null,[[8,27,31,39],[32,,34,38]])}));return function evaluateTargetingConditions(t){return e.apply(this,arguments)}}(),L=n("IpSJ"),H=n("SHZQ"),V=n("Wjfv"),U=n("FAmh"),P=function AddEvaluationResultToAuditLog(e){var t=e.auditLog,n=e.isServerGenerated,a=void 0===n||n,r=e.evaluationResults,c=e.didMatch,i=e.campaignId,o=e.priority,u=e.status,s=void 0===u?f.b.EVALUATED:u;if(t.conditionGroups){var l=a?F(r):r;t.conditionGroups.push({status:s,matched:c,conditionSets:l,key:i,priority:o})}},F=function _generateAuditLogForServerEvaluationResults(e){return Object(d.a)(function(e){return e.evaluatedTargetConditionSet},e).map(function(e){return G(e)})},G=function _generateAuditLogResultForConditionSet(e){var t=Object(O.a)(null,["evaluatedTargetCondition","condition"],e),n=Object(O.a)(!1,["evaluatedTargetCondition","matched"],e),a=Object(O.a)(null,["evaluatedTargetCondition","actualValue"],e);return{status:f.b.EVALUATED,targetingConditions:[{evaluatedCondition:t,matched:n,actualValue:a,status:f.b.EVALUATED,meta:{}}]}},B=function(){var e=Object(u.a)(o.a.mark(function _callee(e){var t,n;return o.a.wrap(function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(e&&e.conditionGroups.length){a.next=2;break}return a.abrupt("return");case 2:return a.prev=2,a.next=5,Object(H.f)(Object(c.a)(Object(c.a)({},e),Object(U.c)()));case 5:t=a.sent,n=t.data,s.a.dispatch(Object(V.c)({campaignEvalId:n.targetingEvaluationUUID})),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(2),Object(p.v)(["Failed to persist targeting audit log",a.t0]);case 13:case"end":return a.stop()}},_callee,null,[[2,10]])}));return function SaveAuditLog(t){return e.apply(this,arguments)}}();n.d(t,"b",function(){return X}),n.d(t,"c",function(){return z}),n.d(t,"d",function(){return K}),n.d(t,"a",function(){return Z});var W=["secondsOnSite","secondsOnPage","scrollPct","exitIntent"],J=function(){var e=Object(u.a)(o.a.mark(function _callee(e){var t,n,a,r;return o.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return t=e.filter(function(e){return!e.allConditionsFullyEvaluated&&e.allConditionsPotentiallyMatched}),n=t.map(function(e){return e.evaluatedTargetConditionSet}),a=n.map(function(e){return e.map(function(e){return e.evaluatedTargetCondition}).map(function(e){return e.condition})}),c.next=5,Object(L.b)();case 5:return r=c.sent,c.next=8,D({conditions:a,context:r});case 8:return c.abrupt("return",c.sent);case 9:case"end":return c.stop()}},_callee)}));return function _evaluateTargetingForEvaluationResults(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(u.a)(o.a.mark(function _callee3(e){var t,n,a,r,i,l,d=arguments;return o.a.wrap(function _callee3$(f){for(;;)switch(f.prev=f.next){case 0:if(t=d.length>1&&void 0!==d[1]?d[1]:function(){},n=Object(p.u)(),a=function(){var a=Object(u.a)(o.a.mark(function _callee2(){var a,r,i=arguments;return o.a.wrap(function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:return a=i.length>0&&void 0!==i[0]?i[0]:{},o.next=3,Object(L.b)();case 3:return r=o.sent,o.next=6,e.evaluator(Object(c.a)(Object(c.a)({},r),{},{eventContext:a}));case 6:if(o.sent.conditionEvaluation){o.next=9;break}return o.abrupt("return");case 9:e.eventType&&("exitIntent"===e.type&&s.a.dispatch(Object(v.a)()),Object(b.a)({topic:"remove-host-event-listener",message:{id:n,event:e.eventType}}),t());case 10:case"end":return o.stop()}},_callee2)}));return function asyncConditionHandler(){return a.apply(this,arguments)}}(),!e.timer){f.next=12;break}return f.next=6,Object(L.b)();case 6:r=f.sent,i=e.conditionDefinition.value,(l=i-e.selector(r))>0&&setTimeout(a,1e3*l+1e3),f.next=13;break;case 12:Object(b.a)({topic:"add-host-event-listener",message:{id:n,event:e.eventType,handler:a,eventProperties:e.eventProperties||[]}});case 13:case"end":return f.stop()}},_callee3)}));return function _waitForCondition(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(u.a)(o.a.mark(function _callee4(e){var t,n,a,i,u,s,d,p,b,v,O,g,h,E,m;return o.a.wrap(function _callee4$(o){for(;;)switch(o.prev=o.next){case 0:if(e&&e.length){o.next=2;break}return o.abrupt("return",null);case 2:t=Object(c.a)({conditionGroups:[]},Object(U.c)()),n=!0,a=!1,i=void 0,o.prev=6,u=e[Symbol.iterator]();case 8:if(n=(s=u.next()).done){o.next=32;break}if((d=s.value).status!==f.b.EVALUATED||!d.matched){o.next=14;break}t.conditionGroups.push(d),o.next=29;break;case 14:if(d.status!==f.b.PENDING){o.next=29;break}return p=d.conditionSets.filter(function(e){return e.status===f.b.PENDING}).map(function(e){return e.targetingConditions}),b=p.map(function(e){return e.filter(function(e){return e.status===f.b.PENDING}).map(function(e){return e.evaluatedCondition})}),v=p.map(function(e){return e.filter(function(e){return e.status===f.b.EVALUATED})}),O=Object(l.a)(v),o.next=21,Object(L.b)();case 21:return g=o.sent,o.next=24,D({conditions:b,context:g});case 24:h=o.sent,E=h.matched,m=h.evalLog,O.length&&(m[0].targetingConditions=[].concat(Object(r.a)(m[0].targetingConditions),Object(r.a)(O))),t.conditionGroups.push({status:f.b.EVALUATED,matched:E,conditionSets:m,key:d.key,priority:d.priority});case 29:n=!0,o.next=8;break;case 32:o.next=38;break;case 34:o.prev=34,o.t0=o.catch(6),a=!0,i=o.t0;case 38:o.prev=38,o.prev=39,n||null==u.return||u.return();case 41:if(o.prev=41,!a){o.next=44;break}throw i;case 44:return o.finish(41);case 45:return o.finish(38);case 46:return o.abrupt("return",t);case 47:case"end":return o.stop()}},_callee4,null,[[6,34,38,46],[39,,41,45]])}));return function evaluateConditionalSkillTargetingConditions(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(u.a)(o.a.mark(function _callee5(e){var t,n,a,r,c,i,u,s,l;return o.a.wrap(function _callee5$(o){for(;;)switch(o.prev=o.next){case 0:if(e&&e.length){o.next=2;break}return o.abrupt("return",[]);case 2:t=[],n=function toMatchedRule(e){return{id:e.ruleId,priority:e.priority}},a=!0,r=!1,c=void 0,o.prev=7,i=e[Symbol.iterator]();case 9:if(a=(u=i.next()).done){o.next=24;break}if((s=u.value).evaluationMatchOutcome!==f.a.MATCH){o.next=15;break}t.push(n(s)),o.next=21;break;case 15:if(s.evaluationMatchOutcome!==f.a.POTENTIAL_MATCH){o.next=21;break}return o.next=18,J(s.evaluationResults);case 18:l=o.sent,l.matched&&t.push(n(s));case 21:a=!0,o.next=9;break;case 24:o.next=30;break;case 26:o.prev=26,o.t0=o.catch(7),r=!0,c=o.t0;case 30:o.prev=30,o.prev=31,a||null==i.return||i.return();case 33:if(o.prev=33,!r){o.next=36;break}throw c;case 36:return o.finish(33);case 37:return o.finish(30);case 38:return o.abrupt("return",t);case 39:case"end":return o.stop()}},_callee5,null,[[7,26,30,38],[31,,33,37]])}));return function evaluateRoutingTargetingConditions(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(u.a)(o.a.mark(function _callee6(e){var t,n,a,c,i,u,s,l,d,p,b;return o.a.wrap(function _callee6$(o){for(;;)switch(o.prev=o.next){case 0:if(t=e.evaluationMatchOutcome,n=e.evaluationResults,a=void 0===n?[]:n,c=e.onMatched,i=void 0===c?function(){}:c,u=e.onDidNotMatch,s=void 0===u?function(){}:u,l=[],t!==f.a.MATCH){o.next=4;break}return o.abrupt("return",i());case 4:if(t!==f.a.NO_MATCH){o.next=6;break}return o.abrupt("return",s());case 6:if(t!==f.a.POTENTIAL_MATCH){o.next=17;break}return o.next=9,J(a);case 9:if(d=o.sent,p=d.matched,b=d.asyncConditionListeners,!p){o.next=16;break}return o.abrupt("return",i());case 16:l=[].concat(Object(r.a)(l),Object(r.a)(b));case 17:if(l.forEach(function(e){return $(e,function(){return i()})}),l.length){o.next=20;break}return o.abrupt("return",s());case 20:return o.abrupt("return",s());case 21:case"end":return o.stop()}},_callee6)}));return function evaluateWidgetDisplayTargetingConditions(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(u.a)(o.a.mark(function _callee9(e){var t,n,c,i,s,l,p,b,v,O,g,h,E,m,j,_,y,T,C,I,x,S,A,k,w,R,M,N,D,L,H;return o.a.wrap(function _callee9$(V){for(;;)switch(V.prev=V.next){case 0:h=function _ref18(e){return Object(d.a)(function(e){return e.evaluatedTargetConditionSet},e.filter(function(e){return e.fullyEvaluatedAndMatched})).filter(function(e){return e.fullyEvaluated}).map(function(e){return e.evaluatedTargetCondition}).filter(function(e){return e.matched}).map(function(e){return e.condition})},g=function _ref17(e){var t=e.filter(function(e){return"EVALUATED"===e.status}).map(function(e){return e.targetingConditions}).filter(function(e){return e.filter(function(e){return e.matched})});return Object(d.a)(function(e){return e.map(function(e){return e.evaluatedCondition})},t)},t=e.conditions,n=void 0===t?[]:t,c=e.onMatched,i=void 0===c?function(){}:c,s=e.onDidNotMatch,l=void 0===s?function(){}:s,p={conditionGroups:[]},b=[],v=function(){var e=Object(u.a)(o.a.mark(function _callee7(e){var t,n,a;return o.a.wrap(function _callee7$(r){for(;;)switch(r.prev=r.next){case 0:return t=e.campaignId,n=e.matchedConditions,a=(void 0===n?[]:n).map(function(e){return e.field}).filter(function(e){return W.includes(e)}).length>0,r.next=4,B(p);case 4:return i&&i(t,a),r.abrupt("return",Promise.resolve({TAL:p,matched:!0}));case 6:case"end":return r.stop()}},_callee7)}));return function onConditionMatched(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(u.a)(o.a.mark(function _callee8(){return o.a.wrap(function _callee8$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(p);case 2:return l&&l(),e.abrupt("return",Promise.resolve({TAL:p,matched:!1}));case 4:case"end":return e.stop()}},_callee8)}));return function onNoConditionMatched(){return e.apply(this,arguments)}}(),E=!0,m=!1,j=void 0,V.prev=10,_=n.entries()[Symbol.iterator]();case 12:if(E=(y=_.next()).done){V.next=47;break}if(T=Object(a.a)(y.value,2),C=T[0],I=T[1],x=I.campaignId,S=I.evaluationMatchOutcome,A=I.evaluationResults,k=void 0===A?[]:A,S!==f.a.NO_MATCH){V.next=19;break}P({evaluationResults:k,auditLog:p,didMatch:!1,campaignId:x,priority:C+1}),V.next=40;break;case 19:if(S!==f.a.MATCH){V.next=25;break}return P({evaluationResults:k,auditLog:p,didMatch:!0,campaignId:x,priority:C+1}),w=h(k),V.abrupt("return",v({campaignId:x,matchedConditions:w}));case 25:if(S!==f.a.POTENTIAL_MATCH){V.next=40;break}return V.next=28,J(k);case 28:if(R=V.sent,M=R.matched,N=R.asyncConditionListeners,D=R.evalLog,P({auditLog:p,evaluationResults:L=void 0===D?[]:D,didMatch:M,campaignId:x,priority:C+1,isServerGenerated:!1,status:N.length?f.b.PENDING:f.b.EVALUATED}),!M){V.next=39;break}return H=g(L),V.abrupt("return",v({campaignId:x,matchedConditions:H}));case 39:b=[].concat(Object(r.a)(b),Object(r.a)(N));case 40:if(C!==n.length-1){V.next=44;break}if(b.forEach(function(e){return $(e,function(){return Z({conditions:n,onMatched:i,onDidNotMatch:l})})}),b.length){V.next=44;break}return V.abrupt("return",O());case 44:E=!0,V.next=12;break;case 47:V.next=53;break;case 49:V.prev=49,V.t0=V.catch(10),m=!0,j=V.t0;case 53:V.prev=53,V.prev=54,E||null==_.return||_.return();case 56:if(V.prev=56,!m){V.next=59;break}throw j;case 59:return V.finish(56);case 60:return V.finish(53);case 61:return V.abrupt("return",O());case 62:case"end":return V.stop()}},_callee9,null,[[10,49,53,61],[54,,56,60]])}));return function evaluateCampaignTargetingConditions(t){return e.apply(this,arguments)}}()},CYoe:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"d",function(){return c}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return o});var a=n("Cpup"),r=function receiveMarkedTime(e,t){return Object(a.a)({type:"RECEIVE_MARKED_TIME",payload:{name:e,time:t}})},c=function setHasSentImpression(){return Object(a.a)({type:"SET_HAS_SENT_IMPRESSION"})},i=function receiveInitTimestamp(e){return Object(a.a)({type:"RECEIVE_INIT_TIMESTAMP",payload:e})},o=function receiveServerResponseSize(e){return Object(a.a)({type:"RECEIVE_SERVER_RESPONSE_SIZE",payload:e})}},FAmh:function(e,t,n){"use strict";n.d(t,"a",function(){return m}),n.d(t,"c",function(){return j}),n.d(t,"b",function(){return _});var a=n("nfbA"),r=n("mj2O"),c=n.n(r),i=n("7SM1"),o=n("SHZQ"),u=n("QtlZ"),s=n("vjCh"),l=n("La++"),d=n("K7i0"),f=n("SFoa"),p=n("BAMi"),b=n("g6eD"),v=n("i9gz"),O=n("LVcX"),g=n("0lfv"),h=n("ws1h"),E=function(){var e=Object(i.a)(c.a.mark(function _callee(e){var t,n,a,r,i,o,s;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return t=e.forceShow,n=void 0!==t&&t,a=e.targetingResults,r=void 0===a?{}:a,i=u.a.getState().targeting.skipWidgetTargeting,o=function dispatchWidgetTargetingResult(e,t){u.a.dispatch(Object(b.h)({matchedTargeting:t,matchedHours:e}))},c.next=5,Object(h.a)();case 5:if(s=c.sent,!i){c.next=9;break}return o(s,!1),c.abrupt("return");case 9:n?o(!0,!0):Object(p.d)({evaluationMatchOutcome:r.evaluationMatchOutcome,evaluationResults:r.evaluationResults,onMatched:function onMatched(){o(s,!0)},onDidNotMatch:function onDidNotMatch(){return o(s,!1)}});case 10:case"end":return c.stop()}},_callee)}));return function evaluateWidgetTargeting(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(i.a)(c.a.mark(function _callee4(){var e,t,n,r,b,O,h,m,j,y,T,C,I,x,S,A,k,w,R=arguments;return c.a.wrap(function _callee4$(M){for(;;)switch(M.prev=M.next){case 0:if(e=R.length>0&&void 0!==R[0]?R[0]:{},t=e.onDidNotMatch,n=void 0===t?function(){}:t,r=e.unreadCampaignIds,b=void 0===r?[]:r,O=e.evaluatedConditionsResults,h=e.skipCampaignTargeting,m=void 0!==h&&h,j=u.a.getState(),y=j.targeting,T=y.skipCampaigns,C=y.forceShowWidget,I=j.embed.id,x=j.session.campaignRefreshToken,S=function(){var e=Object(i.a)(c.a.mark(function _callee3(e){var t,a,r;return c.a.wrap(function _callee3$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(p.c)(e.routingEvaluationResults);case 2:return t=o.sent,a=m||T,u.a.dispatch(Object(d.r)(t)),o.next=7,E({forceShow:C,targetingResults:e.widgetTargetingResults});case 7:if(!a){o.next=9;break}return o.abrupt("return");case 9:return r=function(){var e=Object(i.a)(c.a.mark(function _callee2(e,t){var n;return c.a.wrap(function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:if(!b.includes(e)){a.next=3;break}return a.abrupt("return",Object(s.h)(e));case 3:n=Object(s.d)(e)||{},"BOT"!==n.type?Object(l.c)(e,t):Object(l.d)(e,n.attributes.playbookId,Object(f.a)(),x,t);case 6:case"end":return a.stop()}},_callee2)}));return function onCampaignMatch(t,n){return e.apply(this,arguments)}}(),o.next=12,Object(p.a)({conditions:e.campaignTargetingResults,onMatched:r,onDidNotMatch:n});case 12:case"end":return o.stop()}},_callee3)}));return function evaluateTargetingConditions(t){return e.apply(this,arguments)}}(),M.prev=7,!T||!C){M.next=11;break}return E({forceShow:!0}),M.abrupt("return");case 11:if(O&&!Object(v.a)(O)){M.next=23;break}return A=_(),M.next=15,Object(o.e)(Object(a.a)(Object(a.a)({embedId:I},A),{},{followingCampaignIds:b,excludedCampaignIds:[]}));case 15:if(k=M.sent,w=k.data){M.next=20;break}return Object(g.n)({data:["Empty payload returned for campaign targeting"],type:"warn"}),M.abrupt("return");case 20:S(w),M.next=24;break;case 23:S(O);case 24:M.next=29;break;case 26:M.prev=26,M.t0=M.catch(7),Object(g.f)(new Error("Failed to evaluate campaign targeting - ".concat(M.t0.message)),M.t0);case 29:case"end":return M.stop()}},_callee4,null,[[7,26]])}));return function evalTargetingAndEnrollment(){return e.apply(this,arguments)}}(),j=function getTargetingEvaluationMetadata(){var e=u.a.getState(),t=e.session,n=e.embed;return{targetingContext:{endUserId:Object(O.a)(void 0,["endUser","id"],t),orgId:n.orgId},evaluationOptions:{ignoreUnknowns:!1}}},_=function getTargetingEvaluationContext(){var e=u.a.getState(),t=e.session,n=t.campaignRefreshToken,a=t.geo,r=t.context,c=t.assignedAgentId,i=Object(v.a)(a)?void 0:a,o=Object(O.a)("",["page","href"],r),s=Object(O.a)({},["conversations","conversations"],e);return{sessionId:n,location:i,pageUrl:o,assignedAgentId:c,hasHadConversations:!Object(v.a)(s),inboxId:Object(O.a)(void 0,["embed","configuration","inboxId"],e)}}},IpSJ:function(e,t,n){"use strict";n.d(t,"b",function(){return b}),n.d(t,"a",function(){return v});var a=n("mj2O"),r=n.n(a),c=n("7SM1"),i=n("SHZQ"),o=n("QtlZ"),u=n("mfas"),s=n("0lfv"),l=n("7oto"),d=n("BAMi"),f=n("FAmh"),p=function omitPropertyFromConditionSetList(e,t){return e.map(function(e){return e.map(function(e){return Object(u.a)([t],e)})})},b=function(){var e=Object(c.a)(r.a.mark(function _callee(){var e,t,n,a,c,i,u,s,d,f,p,b,v,O,g,h,E;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return e=o.a.getState(),t=e.embed,n=e.session,a=e.targeting,c=void 0===a?{}:a,r.next=3,Object(l.a)({topic:"get-window-context"});case 3:return i=r.sent,u=i.data,s=void 0===u?{}:u,r.next=8,Object(l.a)({topic:"get-host-cookies"});case 8:return d=r.sent,f=d.data,p=void 0===f?{}:f,r.next=13,Object(l.a)({topic:"get-host-referrer"});case 13:return b=r.sent,v=b.data,O=void 0===v?"":v,r.next=18,Object(l.a)({topic:"get-scrollable-height"});case 18:return g=r.sent,h=g.data,E={_window:s,visitInformation:n.visitInformation,cookies:p,geo:n.geo,embed:t,referrer:O,scrollableHeight:h,hasExitIntent:c.hasExitIntent},r.abrupt("return",Promise.resolve(E));case 22:case"end":return r.stop()}},_callee)}));return function generateTargetingContext(){return e.apply(this,arguments)}}(),v=function(){var e=Object(c.a)(r.a.mark(function _callee2(){var e,t,n,a,c,u,l,b=arguments;return r.a.wrap(function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:return e=b.length>0&&void 0!==b[0]?b[0]:[],t=e.map(function(e){var t=p(e.conditionSets,"mapValue");return{key:"".concat(e.outputKey,"-").concat(e.label),priority:e.priority,conditionSets:t}}),n=o.a.getState(),a=n.embed,c=Object(f.b)(),r.prev=4,r.next=7,Object(i.b)(a.id,{clientSideContext:c,conditionGroups:t});case 7:return u=r.sent,l=u.data,r.next=11,Object(d.b)(l);case 11:return r.abrupt("return",r.sent);case 14:r.prev=14,r.t0=r.catch(4),Object(s.n)({data:["Failed to evaluate conditional skill",r.t0]});case 17:case"end":return r.stop()}},_callee2,null,[[4,14]])}));return function evaluateTargetingForConditionalSets(){return e.apply(this,arguments)}}()},OA1u:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return i}),n.d(t,"e",function(){return o}),n.d(t,"a",function(){return u});var a=n("Cpup"),r=function setShouldSkipCampaigns(e){return Object(a.a)({type:"SET_SHOULD_SKIP_CAMPAIGNS",payload:e})},c=function setShouldSkipWidgetTargeting(e){return Object(a.a)({type:"SET_SHOULD_SKIP_WIDGET_TARGETING",payload:e})},i=function setShouldForceShowWidget(e){return Object(a.a)({type:"SET_SHOULD_FORCE_SHOW_WIDGET",payload:e})},o=function updateOnlineStatus(e){return Object(a.a)({type:"UPDATE_ONLINE_STATUS",payload:e})},u=function setHasExitIntent(){return Object(a.a)({type:"SET_HAS_EXIT_INTENT"})}},"X9/c":function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"a",function(){return d}),n.d(t,"d",function(){return f}),n.d(t,"b",function(){return p});var a,r=n("mj2O"),c=n.n(r),i=n("7SM1"),o=n("7oh4"),u=n("7oto");!function(e){e.SHOW="show",e.HIDE="hide",e.NONE="none"}(a||(a={}));var s=function setControllerDimensions(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(u.a)({topic:"set-frame-dimensions",message:{height:"".concat(e,"px"),name:"controller",width:"".concat(t,"px")}})},l=function setControllerHeight(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.NONE;Object(u.a)({topic:"set-frame-height",message:{height:"".concat(e,"px"),name:"controller",max:!1,intent:t}})},d=function(){var e=Object(i.a)(c.a.mark(function _callee(){var e;return c.a.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.a)({topic:"get-frame-height",message:{name:"controller"}});case 2:if(e=t.sent,"0px"!==e.data){t.next=6;break}return t.abrupt("return");case 6:l(0,a.HIDE);case 7:case"end":return t.stop()}},_callee)}));return function hideWidgetController(){return e.apply(this,arguments)}}(),f=function(){var e=Object(i.a)(c.a.mark(function _callee2(){var e;return c.a.wrap(function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.a)({topic:"get-frame-height",message:{name:"controller"}});case 2:if(e=t.sent,"0px"===e.data){t.next=6;break}return t.abrupt("return");case 6:l(o.a,a.SHOW);case 7:case"end":return t.stop()}},_callee2)}));return function showWidgetController(){return e.apply(this,arguments)}}(),p=function resetControllerSize(){l(o.a),function setControllerWidth(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(u.a)({topic:"set-frame-width",message:{width:"".concat(e,"px"),name:"controller"}})}(o.b)}},YA8z:function(e,t,n){"use strict";var a=n("zygl"),r=n("UXSh"),c=n("iL91"),i=n("BHzW"),o=n("9udt"),u=n("6iwg"),s=n("7Dgk"),l=n("uzby"),d=n("r/xD"),f=n("7oto"),p=n("Cpup"),b={sentryConfig:d.b},v=Object(p.b)(b,{RECEIVE_SENTRY_CONFIG:function receiveSentryConfig(e){var t=e.action;e.draft.sentryConfig=t.payload,Object(f.a)({topic:"set-value-on-host-window",message:{key:"drift_sentry_config",value:t.payload}})}}),O={RECEIVE_MARKED_TIME:function handleReceiveMarkedtime(e){var t=e.action;e.draft.timeByName[t.payload.name]=t.payload.time},RECEIVE_INIT_TIMESTAMP:function receiveInitTimestampHandler(e){var t=e.action;e.draft.initTimestamp=t.payload},RECEIVE_SERVER_RESPONSE_SIZE:function receiveServerResponseSizeHandler(e){var t=e.action,n=e.draft,a=t.payload.size;n.loadCostInBytes+=a}},g=Object(p.b)({loadCostInBytes:0,initTimestamp:null,timeByName:{}},O),h=n("mj2O"),E=n.n(h),m=n("7SM1"),j=n("QtlZ"),_=n("SsZN"),y=n("PCkZ"),T=n("SHZQ"),C=n("K7i0"),I=n("BAMi"),x=n("FAmh"),S=n("mfas"),A=n("0lfv"),k=function(){var e=Object(m.a)(E.a.mark(function _callee(){var e,t,n,a,r,c,i,o;return E.a.wrap(function _callee$(u){for(;;)switch(u.prev=u.next){case 0:return e=j.a.getState(),t=e.embed,n=void 0===t?{}:t,a=Object(x.b)(),r=Object(S.a)(["inboxId"],a),u.prev=3,u.next=6,Object(T.c)(n.id,r);case 6:if(c=u.sent,i=c.data){u.next=10;break}return u.abrupt("return");case 10:return u.next=12,Object(I.c)(i.routingEvaluationResults);case 12:o=u.sent,j.a.dispatch(Object(C.r)(o)),u.next=19;break;case 16:u.prev=16,u.t0=u.catch(3),Object(A.v)(["Failed to re-evaluate routing rules",u.t0]);case 19:case"end":return u.stop()}},_callee,null,[[3,16]])}));return function reevaluateRoutingRules(){return e.apply(this,arguments)}}(),w=n("LVcX"),R=n("U3QC"),M=n("icD7"),N=n("z5yO"),D=n("nfbA"),L={IDENTIFY_LEAD:function identifyLeadHandler(e){var t=e.action;e.draft.endUser.email=t.payload},RECEIVE_GEO:function receiveGeoHandler(e){var t=e.action;e.draft.geo=t.payload},RECEIVE_ACCESS_TOKEN:function receiveAccessTokenHandler(e){var t=e.action;e.draft.auth.accessToken=t.payload.accessToken},RECEIVE_CHAT_SOCKET_AUTH:function receiveChatSocketAuthHandler(e){var t=e.action,n=e.draft;n.auth.socket=Object(D.a)(Object(D.a)({},n.auth.socket),{},{chat:t.payload})},RECEIVE_PRESENCE_SOCKET_AUTH:function receivePresenceSocketAuthHandler(e){var t=e.action,n=e.draft;n.auth.socket=Object(D.a)(Object(D.a)({},n.auth.socket),{},{visitor_presence:t.payload})},RECEIVE_SOCKET:function receiveSocketHandler(e){var t=e.action,n=e.draft,a=Object(w.a)(null,["payload","cluster"],t);a&&(n.sockets[a]={channels:{}})},RECEIVE_CHANNEL:function receiveChannelHandler(e){var t=e.action,n=e.draft,a=Object(w.a)(null,["payload","cluster"],t);a&&(n.sockets[a].channels[t.payload.key]=t.payload.channel)},RECEIVE_END_USER:function receiveEndUserHandler(e){var t=e.action,n=e.draft,a=!!t.payload.assignedAgentId;n.endUser=Object(D.a)(Object(D.a)({},n.endUser),t.payload.endUser),n.isOutbound=a,a&&(n.assignedAgentId=t.payload.assignedAgentId)},RECEIVE_EXTERNAL_ID:function receiveExternalIdHandler(e){var t=e.action;e.draft.externalId=t.payload},UPDATE_INSTANCE_ID:function updateInstanceIdHandler(e){var t=e.action;e.draft.instanceId=t.payload},RECEIVE_EXTERNAL_EMAIL:function receiveExternalEmailHandler(e){var t=e.action;e.draft.endUser.externalEmail=t.payload},RECEIVE_EXTERNAL_JWT:function receiveExternalJwtHandler(e){var t=e.action,n=e.draft;n.endUser.userJwt=t.payload,n.endUser.waitForUserJwt=!1},WAIT_FOR_EXTERNAL_JWT:function waitForExternalJwtHandler(e){e.action;e.draft.endUser.waitForUserJwt=!0},RECEIVE_GDPR:function receiveGDPRHandler(e){var t=e.action,n=e.draft;n.gdpr=Object(D.a)(Object(D.a)({},n.gdpr),t.payload)},DECLINED_GDPR:function declinedGDPRHandler(e){var t=e.action,n=e.draft;n.gdpr=Object(D.a)(Object(D.a)({},n.gdpr),{},{declinedConsent:t.payload})},RECEIVE_CONTEXT:function receiveContextHandler(e){var t=e.action;e.draft.context=t.payload},RECEIVE_SESSION:function receiveSessionHandler(e){var t=e.action,n=e.draft;n.id=t.payload.session.sessionId,n.sessionStarted=t.payload.session.sessionStarted,n.campaignRefreshToken=t.payload.session.campaignRefreshToken,n.instanceId=t.payload.session.instanceId},RECEIVE_COOKIE_DOMAIN:function receiveCookieDomainHandler(e){var t=e.action,n=e.draft,a=Object(w.a)(null,["payload","cookieDomain"],t);n.cookieDomain=a},RECEIVE_UPDATED_CAMPAIGN_REFRESH_TOKEN:function receiveUpdatedCampaignRefreshTokenHandler(e){var t=e.action;e.draft.campaignRefreshToken=t.payload},RECEIVE_VISIT_INFO:function receiveVisitInformation(e){var t=e.action;e.draft.visitInformation=t.payload}},H=Object(p.b)({geo:{},auth:{},sockets:{},endUser:{},isOutbound:!1,gdpr:{needsConsent:!0,hasConsent:!1,declinedConsent:!1},externalId:null,instanceId:"",id:null,sessionStarted:null,cookieDomain:"",context:{page:{},timezone:"",userAgent:"",locale:""},visitInformation:{}},L),V={SET_HAS_EXIT_INTENT:function setHasExitIntentHandler(e){e.draft.hasExitIntent=!0},UPDATE_ONLINE_STATUS:function updateOnlineStatusHandler(e){var t=e.action;e.draft.isOnline=t.payload},SET_SHOULD_SKIP_CAMPAIGNS:function setShouldSkipCampaignsHandler(e){var t=e.action;e.draft.skipCampaigns=t.payload},SET_SHOULD_FORCE_SHOW_WIDGET:function setShouldForceShowWidgetHandler(e){var t=e.action;e.draft.forceShowWidget=t.payload},SET_SHOULD_SKIP_WIDGET_TARGETING:function setShouldSkipWidgetTargetingHandler(e){var t=e.action;e.draft.skipWidgetTargeting=t.payload}},U=Object(p.b)({skipCampaigns:!1,skipWidgetTargeting:!1,forceShowWidget:!1,isOnline:!1,hasExitIntent:!1},V),P=n("vjCh"),F=n("qixE"),G=n("TDUE"),B=n("qwiD"),W=n("X9/c"),J=n("Jg5f"),$=n("MFhO"),X=n("g6eD"),z=function hasActiveConversation(e){return!!e.conversations.activeConversation},K=function(){var e=Object(m.a)(E.a.mark(function _callee(){return E.a.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:if(!z(j.a.getState())){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(F.e)();case 4:if(!e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,Object(P.g)();case 9:case"end":return e.stop()}},_callee)}));return function showFallbackChatContentIfNeeded(){return e.apply(this,arguments)}}(),Z=n("hm8b"),Q={INIT_COMPLETE:function toggleInitCompleteHandler(e){var t=e.action;e.draft.initComplete=t.payload.initComplete},SET_CLOSE_CHAT_REDIRECT_URL:function setCloseChatRedirectUrl(e){var t=e.action;e.draft.closeChatRedirectUrl=t.payload},OPEN_CHAT:function chatOpenHandler(e){e.draft.chatOpen=!0},CLOSE_CHAT:function chatClosedHandler(e){e.draft.chatOpen=!1},TOGGLE_CHAT_TAKEOVER:function toggleChatTakeoverHandler(e){var t=e.action,n=e.draft;t.payload&&(n.conversationHistoryOpen=!1)},TOGGLE_CONVERSATION_HISTORY:function toggleConversationHistoryHandler(e){var t=e.action;e.draft.conversationHistoryOpen=t.payload.conversationHistoryOpen},TOGGLE_WIDGET_TARGETING_MATCHED:function toggleWidgetTargetingCompleteHandler(e){var t=e.action,n=e.draft,a=t.payload,r=a.matchedHours,c=a.matchedTargeting;Object(Z.a)(r)||(n.matchedHours=r),Object(Z.a)(c)||(n.matchedTargeting=c)}},Y=Object(p.b)({chatOpen:!1,closeChatRedirectUrl:null,conversationHistoryOpen:!1,initComplete:!1,isChatTakeover:!1,matchedHours:!1,matchedTargeting:!1},Q),q=n("9OUN"),ee=n("Obtf");n.d(t,"b",function(){return ne}),n.d(t,"a",function(){return ae});var te=Object(q.c)({view:Y,embed:u.a,metrics:g,session:H,targeting:U,conversations:i.a,campaigns:r.a,identity:s.a,impressions:l.a,logging:v}),ne=function rootReducer(e,t){return"REPLACE_STATE"===t.type&&(e=t.payload.currentState),te(e,t)},ae=Object(ee.a)(function onToggleChatEpic(e){return e.pipe(Object(p.c)("TOGGLE_CHAT"),Object(N.a)(function(){return"controller"===j.a.name}),Object(R.a)(function(){var e=Object(m.a)(E.a.mark(function _callee2(e){var t;return E.a.wrap(function _callee2$(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.payload,Object(_.d)(t.chatOpen),t.isChatTakeover&&j.a.dispatch(Object(X.e)(t.isChatTakeover)),!t.chatOpen){n.next=11;break}if(Object(W.b)(),t.displayGreeting){n.next=8;break}return n.next=8,K();case 8:j.a.dispatch(Object(X.d)()),n.next=13;break;case 11:j.a.dispatch(Object(X.c)()),j.a.dispatch(Object(B.c)(!1));case 13:case"end":return n.stop()}},_callee2)}));return function(t){return e.apply(this,arguments)}}()),Object(M.a)())},function onCloseChatCompleteCampaignEpic(e){return e.pipe(Object(p.c)("TOGGLE_CHAT"),Object(N.a)(function(){return"controller"===j.a.name}),Object(N.a)(function(e){return!e.payload.chatOpen}),Object(J.a)(function(){return function activeCampaign(e){return e.campaigns.activeCampaign}(j.a.getState())}),Object(N.a)(function(e){return!!e}),Object(N.a)(function(e){return Object(w.a)(null,["attributes","campaignDisplayType"],e)===$.a.WELCOME_MESSAGE}),Object(R.a)(function(e){var t=Object(w.a)(null,["id"],e),n=Object(w.a)(null,["attributes","playbookId"],e);Object(P.i)(t,n),Object(G.c)(n)}),Object(M.a)())},c.c,c.b,o.a,function pushToChannelEpic(e,t){return e.pipe(Object(p.c)("PUSH_TO_CHANNEL"),Object(R.a)(function(e){var n=e.meta,a=e.payload,r=n||{},c=r.clusterName,i=r.channelName,o=r.eventName;if(o&&c&&i){var u=Object(w.a)(null,["session","sockets",c,"channels",i],t.value);u&&u.push(o,a)}}),Object(M.a)())},function updateEndUserEmailEpic(e,t){return e.pipe(Object(p.c)("IDENTIFY_LEAD"),Object(N.a)(function(){return"controller"===j.a.name}),Object(R.a)(function(){var e=Object(m.a)(E.a.mark(function _callee(e){var t;return E.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload.email,n.next=3,Object(y.c)({email:t});case 3:Object(_.h)({email:t}),k();case 5:case"end":return n.stop()}},_callee)}));return function(t){return e.apply(this,arguments)}}()),Object(M.a)())},o.b,c.a,a.a)},da4L:function(e,t,n){"use strict";n.d(t,"l",function(){return E}),n.d(t,"m",function(){return m}),n.d(t,"n",function(){return j}),n.d(t,"d",function(){return y}),n.d(t,"g",function(){return T}),n.d(t,"i",function(){return C}),n.d(t,"a",function(){return I}),n.d(t,"e",function(){return x}),n.d(t,"h",function(){return S}),n.d(t,"j",function(){return A}),n.d(t,"o",function(){return R}),n.d(t,"c",function(){return M}),n.d(t,"b",function(){return N}),n.d(t,"f",function(){return D}),n.d(t,"k",function(){return L});var a=n("nfbA"),r=n("8lq6"),c=n("oQJ1"),i=n("dMPp"),o=n("yzXs"),u=n("YsSj"),s=n("DboL"),l=n("RhEL"),d=n("CDfd"),f=n("hm8b"),p=n("LVcX"),b=n("Jstd"),v=n("Ry6R"),O=n("A5mO"),g=n("PjZB"),h=n("0lfv"),E=Object(r.a)([Object(c.a)(Object(i.a)("createdAt"))]),m=function shouldReceiveMessage(e){var t=e.contentType===g.c.CHAT&&(!!e.body.length||!!e.attributes.appointmentInfo||!!e.attributes.startInteraction),n=e.contentType===g.c.EMAIL_CAPTURE_CARD,a=e.attachments&&e.attachments.length>0,r=A(e)||k(e);return t||n||a||r},j=Object(o.a)(Object(u.a)(function(e){return!!e.body||!x(e,"startInteraction")}),Object(u.a)(m),E,s.a),_=function shouldGroupMessages(e,t){return C(e)&&C(t)||Object(l.a)(e.authorType,t.authorType)&&Object(l.a)(e.authorId,t.authorId)&&Object(O.a)(t.attributes.generatedAt||t.createdAt).isBefore(Object(O.a)(e.attributes.generatedAt||e.createdAt).add(2,"hour"))},y=function groupMessages(e){return Object(d.a)(_,e)},T=function isEmptyMessage(e){return!e||!e.replace(/<\/?p[^>]*>/g,"").trim()},C=function isMeetingScheduleMessage(e){var t=e.attributes,n=t.offerSchedule,a=t.presentSchedule,r=t.scheduleMeetingFlow,c=t.appointmentInfo;return!Object(f.a)(n)||!Object(f.a)(a)||!Object(f.a)(r)||!Object(f.a)(c)},I=function getMessageAttribute(e,t){return Object(p.a)(null,["attributes",t],e)},x=function hasMessageAttribute(e,t){return!!I(e,t)},S=function isEndUserMessage(e){return!!e&&(e.authorType===g.b.LEAD||e.authorType===g.b.END_USER)},A=(Object(b.a)(function(e){return e.authorType===g.b.USER&&!x(e,"isBot")}),function isRateConversationCTAMessage(e){return"BOT_CONVERSATION_RATING"===e.contentType&&e.authorType===g.b.USER&&x(e,"ratingPrompt")}),k=function isConversationRatingMessage(e){return"BOT_CONVERSATION_RATING"===e.contentType&&x(e,"conversationRating")},w=function truncateMessageText(e){return Object(v.a)(100,e)[0].trim()},R=function truncateMessagePreview(e,t){var n=I(e,"preview");if(n&&n.length>t){var r=w(n);return Object(a.a)(Object(a.a)({},e),{},{attributes:Object(a.a)(Object(a.a)({},e.attributes),{},{preview:"".concat(r,"...")})})}return e},M=function getMessagePreviewText(e){return"BOT_CONVERSATION_RATING"===e.contentType?w(I(e,"ratingPrompt").ratingPromptMessage):I(e,"preview")},N=function getMessageCreatedAt(e){return e.createdAt||I(e,"generatedAt")},D=function isButtonsOnlyMessage(e){return!!e&&!S(e)&&!!I(e,"isButtonOnly")&&!Object(h.m)(I(e,"buttons"))},L=function messageContainsButtons(e){return!!e&&!S(e)&&!Object(h.m)(I(e,"buttons"))}},g6eD:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"e",function(){return c}),n.d(t,"d",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"f",function(){return u}),n.d(t,"g",function(){return s}),n.d(t,"h",function(){return l}),n.d(t,"a",function(){return d});var a=n("Cpup"),r=function toggleChat(e){return Object(a.a)({type:"TOGGLE_CHAT",payload:e})},c=function toggleChatTakeover(e){return Object(a.a)({type:"TOGGLE_CHAT_TAKEOVER",payload:e})},i=function toggleChatOpen(){return Object(a.a)({type:"OPEN_CHAT"})},o=function toggleChatClosed(){return Object(a.a)({type:"CLOSE_CHAT"})},u=function toggleConversationHistory(e){return Object(a.a)({type:"TOGGLE_CONVERSATION_HISTORY",payload:e})},s=function toggleInitComplete(e){return Object(a.a)({type:"INIT_COMPLETE",payload:e})},l=function toggleMatchedWidgetTargeting(e){return Object(a.a)({type:"TOGGLE_WIDGET_TARGETING_MATCHED",payload:e})},d=function setCloseChatRedirectUrl(e){return Object(a.a)({type:"SET_CLOSE_CHAT_REDIRECT_URL",payload:e})}},jbOz:function(e,t,n){"use strict";var a=n("nfbA"),r=n("mj2O"),c=n.n(r),i=n("7SM1"),o=n("uIJS"),u=n("LvsC"),s=n("qytN"),l=n("7jL2"),d=n("vEWT"),f=n("QtlZ"),p=n("LVcX"),b=n("YvIt"),v=n("0lfv"),O=n("Nlet"),g=n("7BJg"),h=n("t8ds");function _createSuper2(e){return function(){var t,n=Object(l.a)(e);if(function isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(l.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(s.a)(this,t)}}var E=100,m=2e3,j=function(e){Object(u.a)(UsageMetricEventBuffer,e);var t=_createSuper2(UsageMetricEventBuffer);function UsageMetricEventBuffer(){var e;return Object(o.a)(this,UsageMetricEventBuffer),(e=t.call(this,m))._publishBuffer=Object(i.a)(c.a.mark(function _callee(){var t;return c.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return e._events.length||Promise.reject(void 0),n.prev=1,n.next=4,e._hydrateEvents();case 4:return t=n.sent,n.next=7,Object(d.b)(t);case 7:e._resetBuffer(),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(1),e._events.length>=E&&e._resetBuffer(),Object(v.v)(["Failed to send bulk metrics",n.t0]);case 14:case"end":return n.stop()}},_callee,null,[[1,10]])})),e._hydrateEvents=Object(i.a)(c.a.mark(function _callee2(){var t,n,r,i,o,u,s,l,d,g,E,m;return c.a.wrap(function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,h.b.get(b.b);case 2:if(c.t0=c.sent,c.t0){c.next=5;break}c.t0={};case 5:return t=c.t0,n=t.data,r=f.a.getState(),i=r.session,o=r.embed,u=r.metrics,s=Object(p.a)("",["geo","country"],i),l=Object(p.a)("",["context","userAgent"],i),d=Object(v.l)(l),g=Object(O.c)(),E=u.loadCostInBytes,m=e._events.map(function(e){return"loaded"===e.eventName&&(e.attributes.loadSizeInBytes=E),{eventName:"[V2] - ".concat(e.eventName),orgId:o.orgId,embedId:o.id,sessionId:n,instanceId:i.instanceId,attributes:Object(a.a)(Object(a.a)({},e.attributes),{},{isMobile:d})}}),c.abrupt("return",Promise.resolve({id:Object(v.u)(),events:m,timestamp:Date.now(),context:{country:s,locale:g.locale,timezone:g.timezone,url:g.url}}));case 15:case"end":return c.stop()}},_callee2)})),e}return UsageMetricEventBuffer}(g.a);t.a=new j},pvgo:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n("QtlZ"),r=n("4c+F"),c=n("CYoe"),i=function stashLoadRequestResponseSize(e){if(!a.a.getState().view.initComplete){var t=Object(r.b)(e);a.a.dispatch(Object(c.c)({size:t}))}}},qwiD:function(e,t,n){"use strict";n.d(t,"p",function(){return r}),n.d(t,"u",function(){return c}),n.d(t,"i",function(){return i}),n.d(t,"f",function(){return o}),n.d(t,"h",function(){return u}),n.d(t,"q",function(){return s}),n.d(t,"s",function(){return l}),n.d(t,"g",function(){return d}),n.d(t,"k",function(){return f}),n.d(t,"l",function(){return p}),n.d(t,"n",function(){return b}),n.d(t,"b",function(){return v}),n.d(t,"w",function(){return O}),n.d(t,"t",function(){return g}),n.d(t,"m",function(){return h}),n.d(t,"d",function(){return E}),n.d(t,"a",function(){return m}),n.d(t,"o",function(){return j}),n.d(t,"c",function(){return _}),n.d(t,"r",function(){return y}),n.d(t,"v",function(){return T}),n.d(t,"j",function(){return C}),n.d(t,"e",function(){return I});var a=n("Cpup"),r=function receiveGeo(e){return Object(a.a)({type:"RECEIVE_GEO",payload:e})},c=function receiveVisitInformation(e){return Object(a.a)({type:"RECEIVE_VISIT_INFO",payload:e})},i=function receiveContext(e){return Object(a.a)({type:"RECEIVE_CONTEXT",payload:e})},o=function receiveAccessToken(e){return Object(a.a)({type:"RECEIVE_ACCESS_TOKEN",payload:e})},u=function receiveChatSocketAuth(e){return Object(a.a)({type:"RECEIVE_CHAT_SOCKET_AUTH",payload:e})},s=function receivePresenceSocketAuth(e){return Object(a.a)({type:"RECEIVE_PRESENCE_SOCKET_AUTH",payload:e})},l=function receiveSocket(e){return Object(a.a)({type:"RECEIVE_SOCKET",payload:e})},d=function receiveChannel(e){return Object(a.a)({type:"RECEIVE_CHANNEL",payload:e})},f=function receiveEndUser(e){return Object(a.a)({type:"RECEIVE_END_USER",payload:e})},p=function receiveExternalEmail(e){return Object(a.a)({type:"RECEIVE_EXTERNAL_EMAIL",payload:e})},b=function receiveExternalJwt(e){return Object(a.a)({type:"RECEIVE_EXTERNAL_JWT",payload:e})},v=function clearExternalJwt(){return b(null)},O=function waitForExternalJwt(){return Object(a.a)({type:"WAIT_FOR_EXTERNAL_JWT"})},g=function receiveUpdatedCampaignRefreshToken(e){return Object(a.a)({type:"RECEIVE_UPDATED_CAMPAIGN_REFRESH_TOKEN",payload:e})},h=function receiveExternalId(e){return Object(a.a)({type:"RECEIVE_EXTERNAL_ID",payload:e})},E=function identifyLead(e){return Object(a.a)({type:"IDENTIFY_LEAD",payload:e})},m=function clearExternalId(){return h(null)},j=function receiveGDPR(e){return Object(a.a)({type:"RECEIVE_GDPR",payload:e})},_=function declinedGDPR(e){return Object(a.a)({type:"DECLINED_GDPR",payload:e})},y=function receiveSession(e){return Object(a.a)({type:"RECEIVE_SESSION",payload:e})},T=function updateInstanceId(e){return Object(a.a)({type:"UPDATE_INSTANCE_ID",payload:e})},C=function receiveCookieDomain(e){return Object(a.a)({type:"RECEIVE_COOKIE_DOMAIN",payload:e})},I=function pushToChannel(e,t,n,r){return Object(a.a)({type:"PUSH_TO_CHANNEL",meta:{clusterName:e,channelName:t,eventName:n},payload:r})}},r0JT:function(e,t,n){"use strict";var a=n("uIJS"),r=n("LvsC"),c=n("qytN"),i=n("7jL2"),o=n("vEWT"),u=n("0lfv"),s=n("7BJg");function _createSuper2(e){return function(){var t,n=Object(i.a)(e);if(function isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(i.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(c.a)(this,t)}}var l=5e3,d=function(e){Object(r.a)(MetricEventBuffer,e);var t=_createSuper2(MetricEventBuffer);function MetricEventBuffer(){var e;return Object(a.a)(this,MetricEventBuffer),(e=t.call(this,l))._publishBuffer=function(){e._events.length&&(Object(o.a)(e._events).catch(function(e){Object(u.n)({type:"warn",data:["Bulk Metrics Failure"]})}),e._resetBuffer())},e}return MetricEventBuffer}(s.a);t.a=new d},ws1h:function(e,t,n){"use strict";n.d(t,"a",function(){return p}),n.d(t,"b",function(){return b});var a=n("mj2O"),r=n.n(a),c=n("7SM1"),i=n("SHZQ"),o=n("QtlZ"),u=n("OA1u"),s=n("LVcX"),l=n("0lfv"),d=n("moLG"),f=Object(d.a)(Object(c.a)(r.a.mark(function _callee(){var e,t,n;return r.a.wrap(function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return e=o.a.getState().embed.id,a.next=3,Object(i.d)(e);case 3:return t=a.sent,n=t.data,a.abrupt("return",n);case 6:case"end":return a.stop()}},_callee)})),5e3),p=function(){var e=Object(c.a)(r.a.mark(function _callee2(){var e,t;return r.a.wrap(function _callee2$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,f();case 3:return e=n.sent,t=Object(s.a)(!1,["driftOnline"],e),o.a.dispatch(Object(u.e)(t)),n.abrupt("return",t);case 9:return n.prev=9,n.t0=n.catch(0),Object(l.v)(["Failed to fetch online status -  ".concat(n.t0.message),n.t0]),n.abrupt("return",!1);case 13:case"end":return n.stop()}},_callee2,null,[[0,9]])}));return function getIsOnline(){return e.apply(this,arguments)}}(),b=function(){var e=Object(c.a)(r.a.mark(function _callee3(){var e,t,n,a;return r.a.wrap(function _callee3$(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,f();case 3:return e=r.sent,t=e.availableTeams||[],n=Object(s.a)([],["configuration","teams"],o.a.getState().embed),a={},n.forEach(function(e){var n=t.includes(e.id);a[e.id]={isOnline:n}}),r.abrupt("return",a);case 11:return r.prev=11,r.t0=r.catch(0),Object(l.v)(["Failed to fetch team availability",r.t0]),r.abrupt("return",{});case 15:case"end":return r.stop()}},_callee3,null,[[0,11]])}));return function getTeamAvailability(){return e.apply(this,arguments)}}()},z8Kx:function(e,t,n){"use strict";n.d(t,"b",function(){return y}),n.d(t,"e",function(){return T}),n.d(t,"d",function(){return C}),n.d(t,"c",function(){return I}),n.d(t,"a",function(){return x});var a=n("mj2O"),r=n.n(a),c=n("7SM1"),i=n("QtlZ"),o=n("qwiD"),u=n("LVcX"),s=n("LelF"),l=n("8saY"),d=n("0lfv"),f=n("VYE+"),p=n("qeWU"),b=function getExternalId(){var e=i.a.getState().session;return Object(u.a)(null,["externalId"],e)},v=function(){var e=Object(c.a)(r.a.mark(function _callee(){var e,t;return r.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(f.e)(s.e);case 2:return e=n.sent,n.next=5,Object(f.e)(s.d);case 5:if(t=n.sent,!e){n.next=9;break}return Object(f.g)(s.d,e),n.abrupt("return",e);case 9:return n.abrupt("return",t||null);case 10:case"end":return n.stop()}},_callee)}));return function getExternalIdFromCookie(){return e.apply(this,arguments)}}(),O=function setExternalIdCookie(e){Object(f.g)(s.d,e)},g=function(){var e=Object(c.a)(r.a.mark(function _callee2(){return r.a.wrap(function _callee2$(e){for(;;)switch(e.prev=e.next){case 0:return i.a.dispatch(o.a()),e.next=3,Object(f.a)(s.d);case 3:if(!Object(f.d)()){e.next=6;break}return e.next=6,Object(f.a)(s.d,{domain:""});case 6:case"end":return e.stop()}},_callee2)}));return function clearExternalId(){return e.apply(this,arguments)}}(),h=function getUserJwt(){var e=i.a.getState().session;return Object(u.a)(void 0,["endUser","userJwt"],e)},E=function(){var e=Object(c.a)(r.a.mark(function _callee3(){var e;return r.a.wrap(function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.e)(s.f);case 2:if(!(e=t.sent)){t.next=10;break}if(!Object(p.b)(e)){t.next=9;break}return t.next=7,m();case 7:t.next=10;break;case 9:return t.abrupt("return",e);case 10:return t.abrupt("return",void 0);case 11:case"end":return t.stop()}},_callee3)}));return function getUserJwtFromCookie(){return e.apply(this,arguments)}}(),m=function(){var e=Object(c.a)(r.a.mark(function _callee4(){return r.a.wrap(function _callee4$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.a)(s.f);case 2:if(!Object(f.d)()){e.next=5;break}return e.next=5,Object(f.a)(s.f,{domain:""});case 5:case"end":return e.stop()}},_callee4)}));return function clearUserJwtCookie(){return e.apply(this,arguments)}}(),j=function setUserJwtCookie(e){Object(f.h)(s.f,e)},_=function(){var e=Object(c.a)(r.a.mark(function _callee5(){return r.a.wrap(function _callee5$(e){for(;;)switch(e.prev=e.next){case 0:return i.a.dispatch(o.b()),e.next=3,m();case 3:case"end":return e.stop()}},_callee5)}));return function clearUserJwt(){return e.apply(this,arguments)}}(),y=function getExternalEmail(){var e=i.a.getState().session;return Object(u.a)("",["endUser","externalEmail"],e)},T=function(){var e=Object(c.a)(r.a.mark(function _callee6(){var e,t,n,a,c;return r.a.wrap(function _callee6$(r){for(;;)switch(r.prev=r.next){case 0:if(!(b()&&!h())){r.next=7;break}return e=b(),r.next=5,E();case 5:t=r.sent,Object(p.c)(t,e)?g():t&&_();case 7:if(n=null,a=null,r.t0=h(),r.t0){r.next=14;break}return r.next=13,E();case 13:r.t0=r.sent;case 14:if((c=r.t0)&&!Object(p.b)(c)&&(a=c),!a){r.next=21;break}j(a),n=Object(p.a)(a),r.next=28;break;case 21:if(r.t1=b(),r.t1){r.next=26;break}return r.next=25,v();case 25:r.t1=r.sent;case 26:(n=r.t1)&&(O(n),_());case 28:return r.abrupt("return",{externalId:n,userJwt:a});case 29:case"end":return r.stop()}},_callee6)}));return function resolveExternalIdAndUserJwt(){return e.apply(this,arguments)}}(),C=function(){var e=Object(c.a)(r.a.mark(function _callee7(){var e,t,n,a,c,o,s;return r.a.wrap(function _callee7$(r){for(;;)switch(r.prev=r.next){case 0:if(!I()){r.next=10;break}return e=i.a.getState(),t=e.session,n=void 0===t?{}:t,a=Object(u.a)(!1,["endUser","waitForUserJwt"],n),r.next=6,T();case 6:return c=r.sent,o=c.externalId,s=c.userJwt,r.abrupt("return",a&&!s&&!!o);case 10:return r.abrupt("return",!1);case 11:case"end":return r.stop()}},_callee7)}));return function isWaitingForUserJwt(){return e.apply(this,arguments)}}(),I=function isSignedIdentityRequired(){var e=i.a.getState().embed,t=void 0===e?{}:e;return Object(u.a)(l.c.DISABLED,["configuration","theme","signedIdentityRequiredStatus"],t)===l.c.REQUIRED},x=function(){var e=Object(c.a)(r.a.mark(function _callee8(e){var t,n,a,c,o,s;return r.a.wrap(function _callee8$(r){for(;;)switch(r.prev=r.next){case 0:if(t=e.socketCluster,n=e.token,a=e.fn,!(c=Object(u.a)(null,["session","auth","socket","".concat(t)],i.a.getState()))){r.next=4;break}return r.abrupt("return",c);case 4:return r.next=6,a({access_token:n});case 6:if(o=r.sent,s=o.data){r.next=11;break}return Object(d.n)({type:"warn",data:["Empty payload response from ".concat(t," socket auth")]}),r.abrupt("return");case 11:return r.abrupt("return",s);case 12:case"end":return r.stop()}},_callee8)}));return function getAuthForSocketConnection(t){return e.apply(this,arguments)}}()},"zX3+":function(e,t,n){"use strict";n.d(t,"a",function(){return f});var a=n("mssF"),r=n("QtlZ"),c=n("+/Je"),i=n("SsZN"),o=n("bYXQ"),u=n("1tbh"),s=n("LVcX"),l=n("DboL"),d=n("0lfv"),f=function sendMessage(e){var t=r.a.getState().conversations,n=void 0===t?{}:t,a=Object(s.a)(c.a,["activeConversation"],n);return Object(o.c)(a)?p(e):Object(o.b)(e.conversationId)||!e.conversationId?v(e):b(e)},p=function sendMessageForPreRenderedConversation(e){var t=r.a.getState().conversations,n=void 0===t?{}:t,i=Object(s.a)([],["messages",c.b],n),o=Object(l.a)(i).slice(0,-1);return Object(a.c)(o,e).then(function(e){return g(e.data,!1),e}).catch(function(t){O(e,t)})},b=function sendMessageForExistingConversation(e){return Object(a.a)(e).then(function(e){return g(e.data,!1),e}).catch(function(t){O(e,t)})},v=function sendMessageForNewConversation(e){return Object(a.b)(e).then(function(e){return g(e.data,!0),e}).catch(function(t){O(e,t)})},O=function onMessageFailed(e,t){var n=Object(s.a)(null,["response","status"],t),a=Object(s.a)(null,["code"],t);return a&&"ECONNABORTED"===a?(Object(u.a)({message:e,timedOut:!0}),Object(d.f)(new Error("Sending message timed out"),t)):n&&403===n?void 0:Object(d.f)(new Error("Failed To send message"),t)},g=function onMessageSent(e,t){t||Object(i.g)(e),Object(i.l)(e)}}}]);